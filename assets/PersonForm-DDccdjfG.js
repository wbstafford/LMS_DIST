import{c as Q,r,v as te,j as e,B as j,e as A,F as se,t as me,d as ue,al as W,am as X,ar as ee}from"./index-2WPDJfjq.js";import{u as xe}from"./useSubscription-BTmiCD9f.js";const ge=({personId:f,onTeamSelectionChange:C})=>{const{user:u}=Q(),[M,E]=r.useState([]),[w,c]=r.useState([]),[$,p]=r.useState(""),[x,y]=r.useState(1),[g,Z]=r.useState(10),[N,S]=r.useState({}),[H,B]=r.useState(!1),[O,h]=r.useState(""),L=async()=>{var o;const t=sessionStorage.getItem("token");if(!t){h("Authentication token is missing. Please log in again."),j.error("Authentication token is missing. Please log in again.");return}if(!(u!=null&&u.OrgID)){h("User organization ID is undefined."),j.error("User organization ID is undefined.");return}B(!0),h("");try{const s=await A.get(`https://knowvara.com/api/api/auth/org/${u.OrgID}/teams`,{headers:{Authorization:`Bearer ${t}`}});E(s.data),c(s.data)}catch(s){if(A.isAxiosError(s)){const l=((o=s.response)==null?void 0:o.data)||s.message;h(`Error fetching teams: ${l}`),j.error(`Error fetching teams: ${l}`)}else h("Unexpected error fetching teams."),j.error("Unexpected error fetching teams.");E([]),c([])}finally{B(!1)}},P=async()=>{var o;if(!f)return;const t=sessionStorage.getItem("token");if(!t){h("Authentication token is missing. Please log in again."),j.error("Authentication token is missing. Please log in again.");return}try{const s=await A.get(`https://knowvara.com/api/api/auth/users/${f}/teams`,{headers:{Authorization:`Bearer ${t}`}}),l={};s.data.forEach(n=>{l[n.team_id]={member:n.is_member,leader:n.is_leader}}),S(l),C(l)}catch(s){if(A.isAxiosError(s)){const l=((o=s.response)==null?void 0:o.data)||s.message;h(`Error fetching person's teams: ${l}`),j.error(`Error fetching person's teams: ${l}`)}else h("Unexpected error fetching person's teams."),j.error("Unexpected error fetching person's teams.")}};r.useEffect(()=>{u!=null&&u.OrgID&&(L(),f&&P())},[u==null?void 0:u.OrgID,f]);const J=te(t=>{p(t),y(1)},300);r.useEffect(()=>()=>{J.cancel()},[J]),r.useEffect(()=>{const t=$.toLowerCase(),o=M.filter(s=>s.name.toLowerCase().includes(t)||s.description&&s.description.toLowerCase().includes(t));c(o)},[$,M]);const z=x*(g==="All"?w.length:g),G=z-(g==="All"?w.length:g),k=g==="All"?w:w.slice(G,z),F=t=>{const o=t.target.value;Z(o==="All"?"All":Number(o)),y(1)},a=t=>{J(t.target.value)},m=t=>{const o={...N};o[t]?(o[t].member=!o[t].member,!o[t].member&&!o[t].leader&&delete o[t]):o[t]={member:!0,leader:!1},S(o),C(o)},I=t=>{const o={...N};o[t]?(o[t].leader=!o[t].leader,!o[t].member&&!o[t].leader&&delete o[t]):o[t]={member:!1,leader:!0},S(o),C(o)},T=g==="All"?1:Math.ceil(w.length/g);return e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search teams by name or description...",onChange:a,className:"w-full md:w-1/2 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm mb-2 md:mb-0"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2 text-gray-700 text-sm",children:"Show:"}),e.jsxs("select",{value:g,onChange:F,className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:"All",children:"All"})]})]})]}),O&&e.jsx("div",{className:"mb-4 text-red-500",children:O}),H?e.jsx("div",{children:"Loading teams..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b border-gray-200",children:"Name"}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200",children:"Description"}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 text-center",children:"Member"}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 text-center",children:"Leader"})]})}),e.jsx("tbody",{children:k.length>0?k.map((t,o)=>{var s,l;return e.jsxs("tr",{className:o%2===0?"bg-gray-50":"",children:[e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:t.name}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:t.description||"-"}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200 text-center",children:e.jsx("input",{type:"checkbox",checked:((s=N[t.id])==null?void 0:s.member)||!1,onChange:()=>m(t.id)})}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200 text-center",children:e.jsx("input",{type:"checkbox",checked:((l=N[t.id])==null?void 0:l.leader)||!1,onChange:()=>I(t.id)})})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-2 px-4 border-b border-gray-200 text-center",children:"No teams found"})})})]})}),T>1&&e.jsxs("div",{className:"flex justify-center items-center mt-4 space-x-2",children:[e.jsx("button",{onClick:()=>y(t=>Math.max(t-1,1)),disabled:x===1,className:`px-2 py-1 text-sm border rounded-md ${x===1?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Previous"}),Array.from({length:T},(t,o)=>o+1).map(t=>e.jsx("button",{onClick:()=>y(t),className:`px-2 py-1 text-sm border rounded-md ${x===t?"bg-blue-500 text-white":"bg-white hover:bg-gray-100"}`,children:t},t)),e.jsx("button",{onClick:()=>y(t=>Math.min(t+1,T)),disabled:x===T,className:`px-2 py-1 text-sm border rounded-md ${x===T?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Next"})]})]})},he=({personId:f,onCourseSelectionChange:C})=>{const{user:u}=Q(),[M,E]=r.useState([]),[w,c]=r.useState([]),[$,p]=r.useState(""),[x,y]=r.useState(1),[g,Z]=r.useState(10),[N,S]=r.useState([]),[H,B]=r.useState(!1),[O,h]=r.useState(""),L=s=>{p(s),y(1)},P=r.useCallback(te(L,300),[]);r.useEffect(()=>()=>{P.cancel()},[P]);const q=async()=>{var l;if(!(u!=null&&u.OrgID)){h("User organization ID is undefined.");return}const s=sessionStorage.getItem("token");if(!s){h("Authentication token is missing. Please log in again.");return}B(!0),h("");try{const n=await A.get(`https://knowvara.com/api/api/courses/${u.OrgID}`,{headers:{Authorization:`Bearer ${s}`}});Array.isArray(n.data)?(E(n.data),c(n.data)):(console.error("Fetched data is not an array"),E([]),c([]))}catch(n){if(A.isAxiosError(n)){const i=((l=n.response)==null?void 0:l.data)||n.message;h(`Error fetching courses: ${i}`)}else h("Unexpected error fetching courses.");E([]),c([])}finally{B(!1)}},J=async()=>{var l;if(!f)return;const s=sessionStorage.getItem("token");if(!s){h("Authentication token is missing. Please log in again.");return}try{const n=await A.get(`https://knowvara.com/api/api/auth/users/${f}/courses`,{headers:{Authorization:`Bearer ${s}`}});if(Array.isArray(n.data)){const i=n.data.map(v=>({courseId:v.courseId,completionStatus:v.completionStatus,completedDate:v.completedDate?v.completedDate.split("T")[0]:"",dueDate:v.dueDate?v.dueDate.split("T")[0]:""}));S(i),C(i)}}catch(n){if(A.isAxiosError(n)){const i=((l=n.response)==null?void 0:l.data)||n.message;h(`Error fetching enrolled courses: ${i}`)}else h("Unexpected error fetching enrolled courses.");S([])}};r.useEffect(()=>{u!=null&&u.OrgID&&(q(),f&&J())},[u==null?void 0:u.OrgID,f]),r.useEffect(()=>{const s=$.toLowerCase(),l=M.filter(n=>n.Name.toLowerCase().includes(s));c(l),y(1)},[$,M]);const z=x*(g==="All"?w.length:g),G=z-(g==="All"?w.length:g),k=g==="All"?w:w.slice(G,z),F=g==="All"?1:Math.ceil(w.length/g),a=s=>{if(N.find(n=>n.courseId===s)){const n=N.filter(i=>i.courseId!==s);S(n),C(n)}else{const n={courseId:s,completionStatus:"not attempted",completedDate:"",dueDate:void 0},i=[...N,n];S(i),C(i)}},m=s=>{const l=s.target.value;Z(l==="All"?"All":Number(l)),y(1)},I=s=>{P(s.target.value)},T=(s,l)=>{const n=N.map(i=>i.courseId===s?{...i,completionStatus:l}:i);S(n),C(n)},t=(s,l)=>{const n=N.map(i=>i.courseId===s?{...i,completedDate:l}:i);S(n),C(n)},o=(s,l)=>{const n=N.map(i=>i.courseId===s?{...i,dueDate:l}:i);S(n),C(n)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-row justify-between items-center mb-2 mt-1",children:[e.jsx("input",{type:"text",placeholder:"Search courses by name...",onChange:I,className:"w-64 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm mb-2"}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("span",{className:"mr-2 text-gray-700 text-sm mt-1",children:"Show:"}),e.jsxs("select",{value:g,onChange:m,className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:"All",children:"All"})]})]})]}),H?e.jsx("div",{children:"Loading courses..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b border-gray-200",children:"Select"}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200",children:"Name"}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200",children:"Completion Status"}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200",children:"Due Date"}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200",children:"Completed Date"})]})}),e.jsx("tbody",{children:k.length>0?k.map((s,l)=>{const n=N.some(v=>v.courseId===s.Id),i=N.find(v=>v.courseId===s.Id);return e.jsxs("tr",{className:l%2===0?"bg-gray-50":"",children:[e.jsx("td",{className:"py-2 px-4 border-b border-gray-200 text-center",children:e.jsx("input",{type:"checkbox",checked:n,onChange:()=>a(s.Id)})}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:s.Name}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:n&&e.jsxs("select",{value:(i==null?void 0:i.completionStatus)||"not attempted",onChange:v=>T(s.Id,v.target.value),className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm",children:[e.jsx("option",{value:"not attempted",children:"Not Attempted"}),e.jsx("option",{value:"incomplete",children:"Incomplete"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"passed",children:"Passed"}),e.jsx("option",{value:"failed",children:"Failed"})]})}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:n&&e.jsx("input",{type:"date",value:(i==null?void 0:i.dueDate)||"",onChange:v=>o(s.Id,v.target.value),className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm"})}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:n&&e.jsx("input",{type:"date",value:(i==null?void 0:i.completedDate)||"",onChange:v=>t(s.Id,v.target.value),className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm"})})]},s.Id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-2 px-4 border-b border-gray-200 text-center",children:"No courses found"})})})]})}),F>1&&e.jsxs("div",{className:"flex justify-center items-center mt-4 space-x-2",children:[e.jsx("button",{onClick:()=>y(s=>Math.max(s-1,1)),disabled:x===1,className:`px-2 py-1 text-sm border rounded-md ${x===1?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Previous"}),Array.from({length:F},(s,l)=>l+1).map(s=>e.jsx("button",{onClick:()=>y(s),className:`px-2 py-1 text-sm border rounded-md ${x===s?"bg-blue-500 text-white":"bg-white hover:bg-gray-100"}`,children:s},s)),e.jsx("button",{onClick:()=>y(s=>Math.min(s+1,F)),disabled:x===F,className:`px-2 py-1 text-sm border rounded-md ${x===F?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Next"})]}),O&&e.jsx("div",{className:"mt-4 text-red-500",children:O})]})},pe=({personId:f,onLearningPlanSelectionChange:C})=>{const{user:u}=Q(),[M,E]=r.useState([]),[w,c]=r.useState([]),[$,p]=r.useState(""),[x,y]=r.useState(1),[g,Z]=r.useState(10),[N,S]=r.useState(new Set),[H,B]=r.useState(!1),[O,h]=r.useState(""),L=a=>{p(a),y(1)},P=r.useCallback(te(L,300),[]);r.useEffect(()=>()=>{P.cancel()},[P]);const q=async()=>{const a=sessionStorage.getItem("token");if(!a){h("Authentication token is missing. Please log in again."),j.error("Authentication token is missing. Please log in again.");return}if(!(u!=null&&u.OrgID)){h("User organization ID is undefined."),j.error("User organization ID is undefined.");return}B(!0),h("");try{const m=await A.get("https://knowvara.com/api/api/learning-plans",{headers:{Authorization:`Bearer ${a}`},params:{search:$,page:x,limit:g,orgId:u.OrgID}});m.data&&Array.isArray(m.data.data)?(E(m.data.data),c(m.data.data)):(console.error("Fetched Learning Plans data is not valid"),E([]),c([]))}catch(m){console.error("Error fetching Learning Plans:",m),E([]),c([]),h("Failed to fetch Learning Plans."),j.error("Failed to fetch Learning Plans.")}finally{B(!1)}};r.useEffect(()=>{q()},[$,x,g]);const J=async()=>{if(!f)return;const a=sessionStorage.getItem("token");if(!a){h("Authentication token is missing. Please log in again."),j.error("Authentication token is missing. Please log in again.");return}try{const m=await A.get(`https://knowvara.com/api/api/learning-plans/users/${f}/learning-plans`,{headers:{Authorization:`Bearer ${a}`}});if(Array.isArray(m.data.data)){const I=m.data.data.map(T=>T.id);S(new Set(I)),C(I)}}catch(m){console.error("Error fetching user's Learning Plans:",m),h("Failed to fetch user's Learning Plans."),j.error("Failed to fetch user's Learning Plans.")}};r.useEffect(()=>{f&&J()},[f]);const z=a=>{const m=new Set(N);m.has(a)?m.delete(a):m.add(a),S(m),C(Array.from(m))},G=a=>{const m=a.target.value;Z(m==="All"?"All":Number(m)),y(1)};r.useEffect(()=>{const a=$.toLowerCase(),m=M.filter(I=>I.name.toLowerCase().includes(a)||I.description&&I.description.toLowerCase().includes(a)||I.objective&&I.objective.toLowerCase().includes(a));c(m),y(1)},[$,M]);const k=g==="All"?1:Math.ceil(w.length/g),F=g==="All"?w:w.slice((x-1)*g,x*g);return e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search Learning Plans...",onChange:a=>P(a.target.value),className:"w-full md:w-1/2 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm mb-2 md:mb-0"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2 text-gray-700 text-sm",children:"Show:"}),e.jsxs("select",{value:g,onChange:G,className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:"All",children:"All"})]})]})]}),O&&e.jsx("div",{className:"mb-4 text-red-500",children:O}),H?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(se,{className:"animate-spin text-2xl text-blue-500"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b border-gray-200",children:"Enroll"}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200",children:"Name"}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200",children:"Description"}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200",children:"Objective"})]})}),e.jsx("tbody",{children:F.length>0?F.map(a=>e.jsxs("tr",{className:"hover:bg-gray-100",children:[e.jsx("td",{className:"py-2 px-4 border-b border-gray-200 text-center",children:e.jsx("input",{type:"checkbox",checked:N.has(a.id),onChange:()=>z(a.id)})}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:a.name}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:a.description||"N/A"}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:a.objective||"N/A"})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-2 px-4 border-b border-gray-200 text-center",children:"No Learning Plans found."})})})]})}),k>1&&e.jsxs("div",{className:"flex justify-center items-center mt-4 space-x-2",children:[e.jsx("button",{onClick:()=>y(a=>Math.max(a-1,1)),disabled:x===1,className:`px-2 py-1 text-sm border rounded-md ${x===1?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Previous"}),Array.from({length:k},(a,m)=>m+1).map(a=>e.jsx("button",{onClick:()=>y(a),className:`px-2 py-1 text-sm border rounded-md ${x===a?"bg-blue-500 text-white":"bg-white hover:bg-gray-100"}`,children:a},a)),e.jsx("button",{onClick:()=>y(a=>Math.min(a+1,k)),disabled:x===k,className:`px-2 py-1 text-sm border rounded-md ${x===k?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Next"})]})]})},ye=()=>{const{user:f}=Q(),{isUserLimitReached:C,isFetching:u,error:M,refetch:E}=xe(),{personId:w}=me(),[c,$]=r.useState(w),[p,x]=r.useState({FirstName:"",LastName:"",Email:"",Password:"",Admin:"n",Instructor:"n",PhoneNumber:"",JobTitle:"",Department:"",DOB:"",Address:"",City:"",State:"",Country:"",ZipCode:"",OrgID:(f==null?void 0:f.OrgID)||0,imageUrl:""}),[y,g]=r.useState({}),[Z,N]=r.useState([]),[S,H]=r.useState([]),[B,O]=r.useState(!1),[h,L]=r.useState(""),P=ue(),[q,J]=r.useState(!1),[z,G]=r.useState(!1),[k,F]=r.useState(!1),[a,m]=r.useState(null),[I,T]=r.useState(""),[t,o]=r.useState(0),[s,l]=r.useState(null);r.useEffect(()=>{const b=sessionStorage.getItem("origin");l(b)},[]),r.useEffect(()=>{c&&(async()=>{var _,Y;const U=sessionStorage.getItem("token");if(!U){L("Authentication token is missing. Please log in again."),j.error("Authentication token is missing. Please log in again.");return}try{const d=(await A.get(`https://knowvara.com/api/api/auth/users/${c}`,{headers:{Authorization:`Bearer ${U}`}})).data;x({FirstName:d.FirstName||"",LastName:d.LastName||"",Email:d.Email||"",Password:"",Admin:d.Admin||"n",Instructor:d.Instructor||"n",PhoneNumber:d.PhoneNumber||"",JobTitle:d.jobTitle||"",Department:d.department||"",DOB:d.DOB?d.DOB.split("T")[0]:"",Address:d.Address||"",City:d.City||"",State:d.State||"",Country:d.Country||"",ZipCode:d.ZipCode||"",OrgID:d.OrgID||0,imageUrl:d.imageUrl||""}),d.imageUrl&&T(`/content${d.imageUrl}`)}catch(R){A.isAxiosError(R)?(L(`Error fetching user data: ${((_=R.response)==null?void 0:_.data)||R.message}`),j.error(`Error fetching user data: ${((Y=R.response)==null?void 0:Y.data)||R.message}`)):(L("An unexpected error occurred while fetching user data."),j.error("An unexpected error occurred while fetching user data."))}})()},[c]);const n=b=>{g(b)},i=b=>{N(b)},v=b=>{H(b)},D=b=>{const{name:U,value:_}=b.target;x({...p,[U]:_})},ae=async b=>{var Y,R;if(b.preventDefault(),!c&&C){j.error("User limit reached. Please upgrade your plan to add more users.");return}O(!0),L(""),o(0);const U=sessionStorage.getItem("token");if(!U){L("Authentication token is missing. Please log in again."),j.error("Authentication token is missing. Please log in again."),O(!1);return}const _={Authorization:`Bearer ${U}`};try{let d=c;const re={...p,OrgID:(f==null?void 0:f.OrgID)||0,Teams:y,Courses:Z,LearningPlanIds:S};if(c?await A.put(`https://knowvara.com/api/api/auth/users/${c}`,re,{headers:_}):(d=(await A.post("https://knowvara.com/api/api/auth/users",re,{headers:_})).data.id.toString(),$(d),await E()),a&&d){const K=new FormData;K.append("image",a),K.append("orgID",p.OrgID.toString()),K.append("personId",d),await A.post(`https://knowvara.com/api/api/auth/users/${d}/image`,K,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${U}`},onUploadProgress:V=>{if(V.total){const de=Math.round(V.loaded*100/V.total);o(de)}}})}P(s||"/admin/people"),sessionStorage.removeItem("origin"),j.success("User saved successfully.")}catch(d){A.isAxiosError(d)?(L(`Error saving person: ${((Y=d.response)==null?void 0:Y.data)||d.message}`),j.error(`Error saving person: ${((R=d.response)==null?void 0:R.data)||d.message}`)):(L("An unexpected error occurred while saving the person."),j.error("An unexpected error occurred while saving the person."))}finally{O(!1)}},ne=()=>{P(s||"/admin/people"),sessionStorage.removeItem("origin")},oe=()=>{J(b=>!b)},le=()=>{G(b=>!b)},ie=()=>{F(b=>!b)},ce=b=>{var _;const U=(_=b.target.files)==null?void 0:_[0];if(U){m(U);const Y=URL.createObjectURL(U);T(Y)}};return!c&&C?e.jsx("div",{className:"flex justify-center mt-10",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"User Limit Reached"}),e.jsxs("p",{className:"mb-6",children:["You have reached the maximum number of users allowed in your current subscription plan. Please visit the"," ",e.jsx("strong",{children:e.jsx("a",{href:"/admin/settings",className:"text-blue-500 underline",children:"Settings Page"})})," ","to upgrade your plan and add more users."]}),e.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>P("/admin/settings"),children:"Go to Settings"})]})}):!c&&u?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx(se,{className:"animate-spin text-4xl text-blue-500"})}):!c&&M?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Error"}),e.jsx("p",{className:"mb-6",children:M}),e.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>P("/admin/settings"),children:"Go to Settings"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row h-auto min-h-[100%] pb-16",children:[" ",e.jsx("div",{className:"flex flex-col items-start w-full md:w-1/2 border-r border-gray-300 p-4 overflow-y-auto",children:e.jsxs("form",{onSubmit:ae,className:"w-full",id:"person-form",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 text-gray-600",children:c?"Edit Person":"Create New Person"}),h&&e.jsx("div",{className:"mb-4 text-red-500",children:h}),e.jsxs("div",{className:"flex flex-col md:flex-row mb-6",children:[e.jsxs("div",{className:"flex flex-col items-center md:items-start mr-6 mb-4 md:mb-0 w-full md:w-1/5",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[I?e.jsx("img",{src:I,alt:"User Preview",className:"w-32 h-32 object-cover rounded-full mb-2"}):e.jsx("div",{className:"w-32 h-32 bg-gray-200 rounded-full mb-2 flex items-center justify-center",children:"No Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:ce,className:"hidden",id:"upload-image-input"}),e.jsx("label",{htmlFor:"upload-image-input",className:"px-3 py-2 lms-button text-xs cursor-pointer ",children:"Select Image"})]}),t>0&&t<100&&e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${t}%`}})}),t===100&&e.jsx("div",{className:"text-green-500 text-sm mt-2",children:"Image uploaded successfully!"})]}),e.jsxs("div",{className:"flex flex-col w-full md:w-4/5",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-4 mb-4",children:[e.jsxs("div",{className:"flex-1 mb-4 md:mb-0",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"First Name"}),e.jsx("input",{type:"text",name:"FirstName",value:p.FirstName,onChange:D,required:!0,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Last Name"}),e.jsx("input",{type:"text",name:"LastName",value:p.LastName,onChange:D,required:!0,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-4 mb-4",children:[e.jsxs("div",{className:"flex-1 mb-4 md:mb-0",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Email"}),e.jsx("input",{type:"email",name:"Email",value:p.Email,onChange:D,required:!0,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Password"}),e.jsx("input",{type:"password",name:"Password",value:p.Password,onChange:D,required:!c,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400",placeholder:c?"Leave blank to keep current password":""})]})]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-4 mb-4",children:[e.jsxs("div",{className:"flex-1 mb-4 md:mb-0",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Job Title"}),e.jsx("input",{type:"text",name:"JobTitle",value:p.JobTitle,onChange:D,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Department"}),e.jsx("input",{type:"text",name:"Department",value:p.Department,onChange:D,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 mb-4",children:[e.jsxs("div",{className:"w-full md:w-1/2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Date of Birth"}),e.jsx("input",{type:"date",name:"DOB",value:p.DOB,onChange:D,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"})]}),e.jsxs("div",{className:"w-full md:w-1/2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Address"}),e.jsx("input",{type:"text",name:"Address",value:p.Address,onChange:D,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 mb-4",children:[e.jsxs("div",{className:"w-full md:w-1/2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"City"}),e.jsx("input",{type:"text",name:"City",value:p.City,onChange:D,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"})]}),e.jsxs("div",{className:"w-full md:w-1/2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"State"}),e.jsx("input",{type:"text",name:"State",value:p.State,onChange:D,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 mb-4",children:[e.jsxs("div",{className:"w-full md:w-1/2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Country"}),e.jsx("input",{type:"text",name:"Country",value:p.Country,onChange:D,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"})]}),e.jsxs("div",{className:"w-full md:w-1/2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Zip Code"}),e.jsx("input",{type:"text",name:"ZipCode",value:p.ZipCode,onChange:D,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 mb-4",children:[e.jsxs("div",{className:"w-full md:w-1/2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Phone Number"}),e.jsx("input",{type:"text",name:"PhoneNumber",value:p.PhoneNumber,onChange:D,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"})]}),e.jsxs("div",{className:"w-full md:w-1/2 flex items-center mt-8",children:[e.jsx("div",{className:"text-gray-700 font-bold mr-2",children:"Admin"}),e.jsx("input",{type:"checkbox",name:"Admin",checked:p.Admin==="y",onChange:b=>x({...p,Admin:b.target.checked?"y":"n"}),className:"mr-4"}),e.jsx("div",{className:"text-gray-700 font-bold mr-2",children:"Instructor"}),e.jsx("input",{type:"checkbox",name:"Instructor",checked:p.Instructor==="y",onChange:b=>x({...p,Instructor:b.target.checked?"y":"n"}),className:"mr-2"})]})]})]})}),e.jsxs("div",{className:"w-full md:w-1/2 p-4 overflow-y-auto",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-600",children:"Additional User Information"}),e.jsx("hr",{}),e.jsx("div",{className:"mt-4 mb-2",children:e.jsx("button",{type:"button",onClick:oe,className:"flex items-center text-md font-semibold text-gray-600 mb-1 border w-full p-2","aria-expanded":q,"aria-controls":"assign-to-teams",children:q?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"ml-1 mr-2"})," Assign to Teams"]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"ml-1 mr-2"})," Assign to Teams"]})})}),e.jsx(ee.Collapse,{isOpened:q,children:e.jsx("div",{id:"assign-to-teams",className:"mb-6 border w-full rounded-lg px-2 py-2",children:e.jsx(ge,{personId:c,onTeamSelectionChange:n})})}),e.jsx("div",{className:"mb-2",children:e.jsx("button",{type:"button",onClick:le,className:"flex items-center text-md font-semibold text-gray-600 mb-1 border w-full p-2","aria-expanded":z,"aria-controls":"assign-to-courses",children:z?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"ml-1 mr-2"})," Assign to Courses"]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"ml-1 mr-2"})," Assign to Courses"]})})}),e.jsx(ee.Collapse,{isOpened:z,children:e.jsx("div",{id:"assign-to-courses",className:"mb-6 border w-full rounded-lg px-2 py-2",children:e.jsx(he,{personId:c,onCourseSelectionChange:i})})}),e.jsx("div",{className:"mb-4",children:e.jsx("button",{type:"button",onClick:ie,className:"flex items-center text-md font-semibold text-gray-600 mb-1 border w-full p-2","aria-expanded":k,"aria-controls":"assign-to-learning-plans",children:k?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"ml-1 mr-2"})," Assign to Learning Plans"]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"ml-1 mr-2"})," Assign to Learning Plans"]})})}),e.jsx(ee.Collapse,{isOpened:k,children:e.jsx("div",{id:"assign-to-learning-plans",className:"mb-6 border w-full rounded-lg px-2 py-2",children:e.jsx(pe,{personId:c,onLearningPlanSelectionChange:v})})})]})]}),e.jsxs("div",{className:"fixed bottom-0 left-0 w-full bg-white p-4 flex justify-end space-x-4 items-center border-t shadow-lg",children:[e.jsx("button",{type:"button",onClick:ne,className:"py-2 px-4 lms-cancel-button text-sm text-white bg-red-500 hover:bg-red-600 rounded-md",children:"Cancel"}),e.jsx("button",{type:"submit",form:"person-form",className:"py-2 px-4 lms-button text-sm text-white bg-blue-500 hover:bg-blue-600 rounded-md",disabled:B,children:B?e.jsxs("div",{className:"flex items-center",children:[e.jsx(se,{className:"animate-spin mr-2"}),"Saving..."]}):"Submit Person"})]})]})};export{ye as default};
