import{c as re,d as ne,r as s,v as ae,j as e,ap as oe,af as K,ah as le,aq as ie,B as u,e as Y,M as be,A as Ce,al as de,am as ue,ar as me}from"./index-2WPDJfjq.js";/* empty css              */const ve=()=>{const{user:r}=re(),F=ne(),[N,b]=s.useState([]),[T,W]=s.useState({key:"name",direction:"ascending"}),[j,m]=s.useState(""),[M,L]=s.useState(!1),[v,A]=s.useState(!1),[p,D]=s.useState(""),[d,f]=s.useState(1),[l,w]=s.useState(10),[g,y]=s.useState(1),[$,P]=s.useState(!1),[C,E]=s.useState(null),k=ae(n=>{D(n),f(1)},300);s.useEffect(()=>()=>{k.cancel()},[]);const V=async()=>{const n=sessionStorage.getItem("token");if(!n){m("Authentication token is missing. Please log in again."),u.error("Authentication token is missing. Please log in again.");return}if(!(r!=null&&r.OrgID)){m("User organization ID is undefined."),u.error("User organization ID is undefined.");return}L(!0),m("");try{const a=(await Y.get("https://knowvara.com/api/api/learning-plans",{headers:{Authorization:`Bearer ${n}`},params:{search:p,page:d,limit:l,orgId:r.OrgID}})).data;a&&Array.isArray(a.data)?(b(a.data),y(a.totalPages)):(console.error("Fetched Learning Plans data is not valid"),b([]),y(1))}catch(x){console.error("Error fetching Learning Plans:",x),b([]),y(1),m("Failed to fetch Learning Plans."),u.error("Failed to fetch Learning Plans.")}finally{L(!1)}};s.useEffect(()=>{V()},[p,d,l]);const S=s.useMemo(()=>N.filter(n=>n.name.toLowerCase().includes(p.toLowerCase())||n.description&&n.description.toLowerCase().includes(p.toLowerCase())||n.objective&&n.objective.toLowerCase().includes(p.toLowerCase())),[N,p]);s.useEffect(()=>{y(l==="All"?1:Math.ceil(S.length/l)),f(1)},[S,l]);const R=s.useMemo(()=>{if(l==="All")return S;const n=d*l,x=n-l;return S.slice(x,n)},[S,d,l]),q=n=>{let x="ascending";T.key===n&&T.direction==="ascending"&&(x="descending"),W({key:n,direction:x});const a=[...S].sort((h,X)=>{var se,U;const B=((se=h[n])==null?void 0:se.toString().toLowerCase())||"",O=((U=X[n])==null?void 0:U.toString().toLowerCase())||"";return B<O?x==="ascending"?-1:1:B>O?x==="ascending"?1:-1:0});b(a)},H=async n=>{const x=sessionStorage.getItem("token");if(!x){console.error("No token found"),m("Authentication token is missing. Please log in again."),u.error("Authentication token is missing. Please log in again.");return}A(!0);try{await Y.delete(`https://knowvara.com/api/api/learning-plans/${n}`,{headers:{Authorization:`Bearer ${x}`}}),b(N.filter(a=>a.id!==n)),u.success("Learning Plan deleted successfully.")}catch(a){console.error("Error deleting Learning Plan:",a),m("Failed to delete Learning Plan."),u.error("Failed to delete Learning Plan.")}finally{A(!1),P(!1),E(null)}},Q=n=>{const x=n.target.value;if(x==="All")w("All"),y(1);else{const a=Number(x);w(a),y(Math.ceil(S.length/a))}f(1)},G=n=>{k(n.target.value)},o=()=>{F("/admin/learning-plan-form")},i=n=>{F(`/admin/learning-plan-form/${n}`)};return e.jsxs("div",{className:"pb-6",children:[" ",e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex flex-row justify-between items-center mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search learning plans...",onChange:G,className:"w-64 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2 text-gray-700 text-sm ml-2",children:"Show:"}),e.jsxs("select",{value:l,onChange:Q,className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:"All",children:"All"})]})]})]}),e.jsxs("button",{className:"flex items-center px-4 py-2 lms-button text-xs",onClick:o,children:[e.jsx(oe,{className:"mr-2"}),"Create Learning Plan"]})]}),j&&e.jsx("div",{className:"mb-4 text-red-500",children:j}),M?e.jsx("div",{children:"Loading Learning Plans..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>q("name"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"mr-2"}),"Name"]})}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>q("objective"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"mr-2"}),"Objective"]})}),e.jsx("th",{className:"w-8 py-2 px-2 border-b border-gray-200 text-center text-sm"}),e.jsx("th",{className:"w-8 py-2 px-2 border-b border-gray-200 text-center text-sm"})]})}),e.jsx("tbody",{children:R.length>0?R.map((n,x)=>e.jsxs("tr",{className:x%2===0?"bg-gray-50":"",children:[e.jsx("td",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer",onClick:()=>i(n.id),children:n.name}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:n.objective||"N/A"}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(le,{size:18,className:"cursor-pointer lms-icon",onClick:()=>i(n.id),title:"Edit Learning Plan","aria-label":"Edit Learning Plan"})}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(ie,{size:18,className:"cursor-pointer lms-icon",onClick:()=>{E(n.id),P(!0)},title:"Delete Learning Plan","aria-label":"Delete Learning Plan"})})]},n.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-2 px-4 border-b border-gray-200 text-center",children:"No Learning Plans available"})})})]})}),g>1&&e.jsxs("div",{className:"flex justify-center items-center mt-4 space-x-2",children:[e.jsx("button",{onClick:()=>f(n=>Math.max(n-1,1)),disabled:d===1,className:`px-2 py-1 text-sm border rounded-md ${d===1?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Previous"}),Array.from({length:g},(n,x)=>x+1).map(n=>e.jsx("button",{onClick:()=>f(n),className:`px-2 py-1 text-sm border rounded-md ${d===n?"bg-blue-500 text-white":"bg-white hover:bg-gray-100"}`,children:n},n)),e.jsx("button",{onClick:()=>f(n=>Math.min(n+1,g)),disabled:d===g,className:`px-2 py-1 text-sm border rounded-md ${d===g?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Next"})]}),$&&C!==null&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",role:"dialog","aria-modal":"true","aria-labelledby":"delete-lp-modal-title",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-11/12 max-w-md",role:"document",children:[e.jsx("h2",{id:"delete-lp-modal-title",className:"text-xl font-semibold mb-4",children:"Confirm Deletion"}),e.jsx("p",{children:"Are you sure you want to delete this Learning Plan? This action cannot be undone."}),j&&e.jsx("div",{className:"mt-4 text-red-500",children:j}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx("button",{className:`bg-red-600 text-white px-4 py-2 rounded mr-2 hover:bg-red-700 ${v?"opacity-50 cursor-not-allowed":""}`,onClick:()=>H(C),disabled:v,children:v?"Deleting...":"Yes, Delete"}),e.jsx("button",{className:"bg-gray-300 text-black px-4 py-2 rounded hover:bg-gray-400",onClick:()=>{P(!1),E(null),m("")},disabled:v,children:"Cancel"})]})]})})]})},we=()=>{const{user:r}=re(),F=ne(),[N,b]=s.useState([]),[T,W]=s.useState(!1),[j,m]=s.useState(""),[M,L]=s.useState(!1),[v,A]=s.useState(null),[p,D]=s.useState(""),[d,f]=s.useState(""),[l,w]=s.useState(1),[g,y]=s.useState(15),[$,P]=s.useState(1),[C,E]=s.useState(null),z=s.useMemo(()=>ae(a=>{f(a),w(1)},300),[]);s.useEffect(()=>()=>{z.cancel()},[z]);const k=a=>{D(a.target.value),z(a.target.value)},V=a=>{const h=a.target.value;y(h==="All"?"All":Number(h)),w(1)},S=async()=>{const a=sessionStorage.getItem("token");if(!a||!(r!=null&&r.OrgID)){u.error("Authentication token is missing or user is not authenticated.");return}W(!0),m("");try{const h=await Y.get(`https://knowvara.com/api/api/certificates/${r.OrgID}`,{headers:{Authorization:`Bearer ${a}`}});b(h.data)}catch(h){console.error("Error fetching certificates:",h),m("Failed to fetch certificates."),u.error("Failed to fetch certificates.")}finally{W(!1)}};s.useEffect(()=>{r!=null&&r.OrgID&&S()},[r==null?void 0:r.OrgID]);const R=a=>{A(a),L(!0)},q=async()=>{if(!v)return;const a=sessionStorage.getItem("token");if(!a){u.error("Authentication token is missing."),L(!1),A(null);return}try{await Y.delete(`https://knowvara.com/api/api/certificates/${v.id}`,{headers:{Authorization:`Bearer ${a}`}}),u.success("Certificate deleted successfully."),S()}catch(h){console.error("Error deleting certificate:",h),u.error("Failed to delete certificate.")}finally{L(!1),A(null)}},H=()=>{L(!1),A(null)},Q=a=>{F(`/admin/certificate-form/${a}`)},G=()=>{F("/admin/certificate-form")},o=s.useMemo(()=>N.filter(a=>a.name.toLowerCase().includes(d.toLowerCase())),[N,d]),i=s.useMemo(()=>C!==null?[...o].sort((h,X)=>{const B=h[C.key],O=X[C.key];return typeof B=="string"&&typeof O=="string"?B.toLowerCase()<O.toLowerCase()?C.direction==="ascending"?-1:1:B.toLowerCase()>O.toLowerCase()?C.direction==="ascending"?1:-1:0:0}):o,[o,C]);s.useEffect(()=>{P(g==="All"?1:Math.ceil(i.length/g))},[i,g]);const n=s.useMemo(()=>{if(g==="All")return i;const a=l*g,h=a-g;return i.slice(h,a)},[i,l,g]),x=a=>{let h="ascending";C&&C.key===a&&C.direction==="ascending"&&(h="descending"),E({key:a,direction:h})};return e.jsxs("div",{className:"mt-1",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex flex-row items-center space-x-4",children:[e.jsx("input",{type:"text",placeholder:"Search certificates by name...",value:p,onChange:k,className:"w-64 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2 text-gray-700 text-sm",children:"Show:"}),e.jsxs("select",{value:g,onChange:V,className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm",children:[e.jsx("option",{value:15,children:"15"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:"All",children:"All"})]})]})]}),e.jsxs("button",{onClick:G,className:"flex items-center px-4 py-2 lms-button text-xs",children:[e.jsx(oe,{className:"mr-2"}),"Create Certificate"]})]}),T?e.jsx("div",{children:"Loading certificates..."}):j?e.jsx("div",{className:"text-red-500",children:j}):e.jsxs(e.Fragment,{children:[o.length===0?e.jsx("div",{children:"No certificates found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>x("name"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"mr-2"}),"Name"]})}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 text-sm",children:"Description"}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 text-sm",children:"Actions"})]})}),e.jsx("tbody",{children:n.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:a.name}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:a.description}),e.jsxs("td",{className:"py-2 px-4 border-b border-gray-200 w-24",children:[e.jsx("button",{onClick:()=>Q(a.id),className:"text-blue-600 hover:text-blue-800 mr-2",title:"Edit Certificate",children:e.jsx(le,{size:18,className:"cursor-pointer lms-icon"})}),e.jsx("button",{onClick:()=>R(a),className:"text-red-600 hover:text-red-800",title:"Delete Certificate",children:e.jsx(ie,{size:18,className:"cursor-pointer lms-icon"})})]})]},a.id))})]})}),$>1&&e.jsxs("div",{className:"flex justify-center items-center mt-4 space-x-2",children:[e.jsx("button",{onClick:()=>w(a=>Math.max(a-1,1)),disabled:l===1,className:`px-2 py-1 text-sm border rounded-md ${l===1?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Previous"}),Array.from({length:$},(a,h)=>h+1).map(a=>e.jsx("button",{onClick:()=>w(a),className:`px-2 py-1 text-sm border rounded-md ${l===a?"bg-blue-500 text-white":"bg-white hover:bg-gray-100"}`,children:a},a)),e.jsx("button",{onClick:()=>w(a=>Math.min(a+1,$)),disabled:l===$,className:`px-2 py-1 text-sm border rounded-md ${l===$?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Next"})]})]}),M&&v&&e.jsx(be,{title:"Delete Certificate",onClose:H,onConfirm:q,children:e.jsxs("p",{children:["Are you sure you want to delete the certificate"," ",e.jsx("strong",{children:v.name}),"?"]})})]})},Se=()=>{const{user:r}=re(),F=ne(),[N,b]=s.useState([]),[T,W]=s.useState({key:"Name",direction:"ascending"}),[j,m]=s.useState(""),[M,L]=s.useState(!1),[v,A]=s.useState(""),[p,D]=s.useState(1),[d,f]=s.useState(15),[l,w]=s.useState(1),[g,y]=s.useState(!1),[$,P]=s.useState(null),E=ae(o=>{A(o),D(1)},300);s.useEffect(()=>()=>{E.cancel()},[]);const z=async()=>{const o=sessionStorage.getItem("token");if(!o){m("Authentication token is missing. Please log in again."),u.error("Authentication token is missing. Please log in again.");return}if(!(r!=null&&r.OrgID)){m("User organization ID is undefined."),u.error("User organization ID is undefined.");return}L(!0),m("");try{const i=await Y.get(`https://knowvara.com/api/api/bundles/${r.OrgID}`,{headers:{Authorization:`Bearer ${o}`}});console.log("Fetched bundles:",i.data),Array.isArray(i.data)?b(i.data):(console.error("Fetched data is not an array"),b([]))}catch(i){console.error("Error fetching bundles:",i),b([]),m("Failed to fetch bundles."),u.error("Failed to fetch bundles.")}finally{L(!1)}};s.useEffect(()=>{r!=null&&r.OrgID&&z()},[r==null?void 0:r.OrgID]);const k=s.useMemo(()=>N.filter(o=>o.Name.toLowerCase().includes(v.toLowerCase())),[N,v]);s.useEffect(()=>{w(d==="All"?1:Math.ceil(k.length/d)),D(1)},[k,d]);const V=s.useMemo(()=>{if(d==="All")return k;const o=p*d,i=o-d;return k.slice(i,o)},[k,p,d]),S=o=>{let i="ascending";T.key===o&&T.direction==="ascending"&&(i="descending"),W({key:o,direction:i});const n=[...k].sort((x,a)=>{var B,O;const h=((B=x[o])==null?void 0:B.toString().toLowerCase())||"",X=((O=a[o])==null?void 0:O.toString().toLowerCase())||"";return h<X?i==="ascending"?-1:1:h>X?i==="ascending"?1:-1:0});b(n)},R=async o=>{const i=sessionStorage.getItem("token");if(!i){console.error("No token found"),m("Authentication token is missing. Please log in again."),u.error("Authentication token is missing. Please log in again.");return}try{await Y.delete(`https://knowvara.com/api/api/bundles/${r==null?void 0:r.OrgID}/${o}`,{headers:{Authorization:`Bearer ${i}`}}),b(N.filter(n=>n.Id!==o)),u.success("Bundle deleted successfully.")}catch(n){console.error("Error deleting bundle:",n),m("Failed to delete bundle."),u.error("Failed to delete bundle.")}finally{y(!1),P(null)}},q=o=>{const i=o.target.value;if(i==="All")f("All"),w(1);else{const n=Number(i);f(n),w(Math.ceil(k.length/n))}D(1)},H=o=>{E(o.target.value)},Q=()=>{F("/admin/bundle-form")},G=o=>{F(`/admin/bundle-form/${o}`)};return e.jsx("div",{className:"flex flex-col h-auto",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex flex-row justify-between items-center mb-2",children:[e.jsx("input",{type:"text",placeholder:"Search bundles by name...",onChange:H,className:"w-64 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2 text-gray-700 text-sm ml-2",children:"Show:"}),e.jsxs("select",{value:d,onChange:q,className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm",children:[e.jsx("option",{value:15,children:"15"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:"All",children:"All"})]})]})]}),e.jsxs("button",{className:"flex items-center px-4 py-2 lms-button text-xs",onClick:Q,children:[e.jsx(oe,{className:"mr-2"}),"Create New Bundle"]})]}),j&&e.jsx("div",{className:"mb-4 text-red-500",children:j}),M?e.jsx("div",{children:"Loading bundles..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>S("Name"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"mr-2"}),"Name"]})}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 text-sm",children:"Short Description"}),(r==null?void 0:r.ecommerce)&&e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>S("Price"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"mr-2"}),"Price"]})}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 text-sm w-28",children:"# Courses"}),e.jsx("th",{className:"py-2 px-2 border-b border-gray-200 text-center text-sm"}),e.jsx("th",{className:"py-2 px-2 border-b border-gray-200 text-center text-sm"})]})}),e.jsx("tbody",{children:V.length>0?V.map((o,i)=>{var n;return e.jsxs("tr",{className:i%2===0?"bg-gray-50":"",children:[e.jsx("td",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer",onClick:()=>G(o.Id),children:o.Name}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:o.ShortDescription}),(r==null?void 0:r.ecommerce)&&e.jsxs("td",{className:"py-2 px-4 border-b border-gray-200 text-center",children:["$",(n=o.Price)==null?void 0:n.toFixed(2)]}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200 text-center",children:o.courses.length}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(le,{size:18,className:"cursor-pointer lms-icon",onClick:()=>G(o.Id),title:"Edit Bundle","aria-label":"Edit Bundle"})}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(ie,{size:18,className:"cursor-pointer lms-icon",onClick:()=>{P(o.Id),y(!0)},title:"Delete Bundle","aria-label":"Delete Bundle"})})]},o.Id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-2 px-4 border-b border-gray-200 text-center",children:"No bundles available"})})})]})}),l>1&&e.jsxs("div",{className:"flex justify-center items-center mt-4 space-x-2",children:[e.jsx("button",{onClick:()=>D(o=>Math.max(o-1,1)),disabled:p===1,className:`px-2 py-1 text-sm border rounded-md ${p===1?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Previous"}),Array.from({length:l},(o,i)=>i+1).map(o=>e.jsx("button",{onClick:()=>D(o),className:`px-2 py-1 text-sm border rounded-md ${p===o?"bg-blue-500 text-white":"bg-white hover:bg-gray-100"}`,children:o},o)),e.jsx("button",{onClick:()=>D(o=>Math.min(o+1,l)),disabled:p===l,className:`px-2 py-1 text-sm border rounded-md ${p===l?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Next"})]}),g&&$!==null&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",role:"dialog","aria-modal":"true","aria-labelledby":"delete-bundle-modal-title",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-11/12 max-w-md",role:"document",children:[e.jsx("h2",{id:"delete-bundle-modal-title",className:"text-xl font-semibold mb-4",children:"Confirm Deletion"}),e.jsx("p",{children:"Are you sure you want to delete this bundle? This action cannot be undone."}),j&&e.jsx("div",{className:"mt-4 text-red-500",children:j}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx("button",{className:`bg-red-600 text-white px-4 py-2 rounded mr-2 hover:bg-red-700 ${M?"opacity-50 cursor-not-allowed":""}`,onClick:()=>R($),disabled:M,children:M?"Deleting...":"Yes, Delete"}),e.jsx("button",{className:"bg-gray-300 text-black px-4 py-2 rounded hover:bg-gray-400",onClick:()=>{y(!1),P(null),m("")},disabled:M,children:"Cancel"})]})]})})]})})},Pe=()=>{const{user:r}=re(),F=ne(),[N,b]=s.useState([]),[T,W]=s.useState({key:"Name",direction:"ascending"}),[j,m]=s.useState(""),[M,L]=s.useState(!1),[v,A]=s.useState(!1),[p,D]=s.useState(""),[d,f]=s.useState(1),[l,w]=s.useState(12),[g,y]=s.useState(1),[$,P]=s.useState(!1),[C,E]=s.useState(null),[z,k]=s.useState(!1),[V,S]=s.useState(!1),[R,q]=s.useState(!1),[H,Q]=s.useState([]),[G,o]=s.useState(""),[i,n]=s.useState(!1),x=()=>{k(t=>!t)},a=()=>{S(t=>!t)},h=()=>{q(t=>!t)},B=ae(t=>{D(t),f(1)},300);s.useEffect(()=>()=>{B.cancel()},[]);const O=async()=>{const t=sessionStorage.getItem("token");if(!t){o("Authentication token is missing. Please log in again."),u.error("Authentication token is missing. Please log in again.");return}if(!(r!=null&&r.OrgID)){o("User organization ID is undefined."),u.error("User organization ID is undefined.");return}n(!0),o("");try{const c=await Y.get(`https://knowvara.com/api/api/courses/${r.OrgID}/recently-edited`,{headers:{Authorization:`Bearer ${t}`}});console.log("recent data: "+c.data),Q(c.data)}catch(c){console.error("Error fetching recent courses:",c),o("Failed to fetch recently edited courses."),u.error("Failed to fetch recently edited courses.")}finally{n(!1)}};s.useEffect(()=>{r!=null&&r.OrgID&&O()},[location.pathname,r==null?void 0:r.OrgID]);const se=async()=>{const t=sessionStorage.getItem("token");if(!t){m("Authentication token is missing. Please log in again."),u.error("Authentication token is missing. Please log in again.");return}if(!(r!=null&&r.OrgID)){m("User organization ID is undefined."),u.error("User organization ID is undefined.");return}L(!0),m("");try{const c=await Y.get(`https://knowvara.com/api/api/courses/${r.OrgID}`,{headers:{Authorization:`Bearer ${t}`}});console.log("Fetched courses:",c.data),Array.isArray(c.data)?b(c.data):(console.error("Fetched data is not an array"),b([]))}catch(c){console.error("Error fetching courses:",c),b([]),m("Failed to fetch courses."),u.error("Failed to fetch courses.")}finally{L(!1)}};s.useEffect(()=>{r!=null&&r.OrgID&&se()},[r==null?void 0:r.OrgID]);const U=s.useMemo(()=>N.filter(t=>t.Name.toLowerCase().includes(p.toLowerCase())),[N,p]);s.useEffect(()=>{y(l==="All"?1:Math.ceil(U.length/l)),f(1)},[U,l]);const xe=s.useMemo(()=>{if(l==="All")return U;const t=d*l,c=t-l;return U.slice(c,t)},[U,d,l]),ce=t=>{let c="ascending";T.key===t&&T.direction==="ascending"&&(c="descending"),W({key:t,direction:c});const I=[...U].sort((J,Z)=>{var he,ge;const ee=J[t]==="y"?1:J[t]==="n"?0:((he=J[t])==null?void 0:he.toString().toLowerCase())||"",_=Z[t]==="y"?1:Z[t]==="n"?0:((ge=Z[t])==null?void 0:ge.toString().toLowerCase())||"";return ee<_?c==="ascending"?-1:1:ee>_?c==="ascending"?1:-1:0});b(I)},pe=async(t,c)=>{const I=sessionStorage.getItem("token");if(!I){console.error("No token found");return}const J=N.find(_=>_.Id===t);if(!J)return;const Z=r==null?void 0:r.OrgID,ee=J[c]==="y"?"n":"y";try{await Y.patch(`https://knowvara.com/api/api/courses/${Z}/${t}`,{[c]:ee},{headers:{Authorization:`Bearer ${I}`}}),b(N.map(_=>_.Id===t?{..._,[c]:ee}:_)),u.success(`Course ${c} status updated successfully.`)}catch(_){console.error("Error updating course:",_),u.error("Failed to update course status.")}},fe=async t=>{const c=sessionStorage.getItem("token");if(!c){console.error("No token found"),m("Authentication token is missing. Please log in again."),u.error("Authentication token is missing. Please log in again.");return}A(!0);try{await Y.delete(`https://knowvara.com/api/api/courses/${t}`,{headers:{Authorization:`Bearer ${c}`}}),b(N.filter(I=>I.Id!==t)),u.success("Course deleted successfully.")}catch(I){console.error("Error deleting course:",I),m("Failed to delete course."),u.error("Failed to delete course.")}finally{A(!1),P(!1),E(null)}},je=t=>{const c=t.target.value;if(c==="All")w("All"),y(1);else{const I=Number(c);w(I),y(Math.ceil(U.length/I))}f(1)},ye=t=>{B(t.target.value)},Ne=()=>{F("/admin/course-form")},te=t=>{F(`/admin/course-form/${t}`)};return e.jsxs("div",{className:"flex flex-col md:flex-row h-auto min-h-[100%]",children:[e.jsxs("div",{className:"flex flex-col w-full md:w-3/5 p-4 md:border-r border-gray-300",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-600",children:"Courses"}),e.jsxs("button",{className:"flex items-center px-4 py-2 lms-button text-sm",onClick:Ne,children:[e.jsx(oe,{className:"mr-2"}),"Create New Course"]})]}),j&&e.jsx("div",{className:"mb-3 text-red-500",children:j}),e.jsxs("div",{className:"flex flex-row justify-between items-center mb-3",children:[e.jsx("input",{type:"text",placeholder:"Search courses by name...",onChange:ye,className:"w-64 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2 text-gray-700 text-sm",children:"Show:"}),e.jsxs("select",{value:l,onChange:je,className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm",children:[e.jsx("option",{value:12,children:"12"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:"All",children:"All"})]})]})]}),M?e.jsx("div",{children:"Loading courses..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"hidden sm:table-cell w-28 py-2 px-4 border-b border-gray-200",style:{minWidth:"26px"}}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>ce("Name"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"mr-2"}),"Name"]})}),(r==null?void 0:r.ecommerce)&&e.jsx("th",{className:"w-24 py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>ce("Price"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"mr-2"}),"Price"]})}),e.jsx("th",{className:"w-24 py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>ce("Activated"),children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(K,{className:"mr-2"}),"Active"]})}),e.jsx("th",{className:"w-8 py-2 px-2 border-b border-gray-200 text-center text-sm"}),e.jsx("th",{className:"w-8 py-2 px-2 border-b border-gray-200 text-center text-sm"})]})}),e.jsx("tbody",{children:xe.length>0?xe.map((t,c)=>{var I;return e.jsxs("tr",{className:c%2===0?"bg-gray-50":"",children:[e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 hidden sm:table-cell",children:e.jsx("img",{src:t.ImageURL||"/GenericCourseIcon.webp",alt:t.Name,className:"w-28 h-8 md:h-14 object-cover rounded cursor-pointer",style:{minWidth:"30px"},onClick:()=>te(t.Id),onError:J=>{J.target.src="/GenericCourseIcon.webp"}})}),e.jsxs("td",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer",onClick:()=>te(t.Id),children:[e.jsx("div",{className:"text-md font-semibold text-gray-800",children:t.Name}),e.jsx("div",{className:"hidden lg:block text-xs",children:t.ShortDescription})]}),(r==null?void 0:r.ecommerce)&&e.jsxs("td",{className:"w-24 py-2 px-4 border-b border-gray-200 text-center",children:["$",(I=t.Price)==null?void 0:I.toFixed(2)]}),e.jsx("td",{className:"w-24 py-2 px-4 border-b border-gray-200 text-center",children:e.jsx("div",{className:"ml-10",children:e.jsx("input",{type:"checkbox",checked:t.Activated==="y",onChange:()=>pe(t.Id,"Activated"),className:"custom-checkbox"})})}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(le,{size:18,className:"cursor-pointer lms-icon",onClick:()=>te(t.Id),title:"Edit Course","aria-label":"Edit Course"})}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(ie,{size:18,className:"cursor-pointer lms-icon",onClick:()=>{E(t.Id),P(!0)},title:"Delete Course","aria-label":"Delete Course"})})]},t.Id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-2 px-4 border-b border-gray-200 text-center",children:"No courses available"})})})]})}),g>1&&e.jsxs("div",{className:"flex justify-center items-center mt-4 space-x-2",children:[e.jsx("button",{onClick:()=>f(t=>Math.max(t-1,1)),disabled:d===1,className:`px-2 py-1 text-sm border rounded-md ${d===1?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Previous"}),Array.from({length:g},(t,c)=>c+1).map(t=>e.jsx("button",{onClick:()=>f(t),className:`px-2 py-1 text-sm border rounded-md ${d===t?"bg-blue-500 text-white":"bg-white hover:bg-gray-100"}`,children:t},t)),e.jsx("button",{onClick:()=>f(t=>Math.min(t+1,g)),disabled:d===g,className:`px-2 py-1 text-sm border rounded-md ${d===g?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Next"})]}),e.jsx(Ce,{children:$&&C!==null&&e.jsxs(be,{title:"Confirm Deletion",onClose:()=>{P(!1),E(null),m("")},onConfirm:()=>fe(C),confirmText:v?"Deleting...":"Yes, Delete",isConfirmDisabled:v,singleButton:!1,widthClassName:"max-w-md",children:[e.jsx("p",{children:"Are you sure you want to delete this course? This action cannot be undone."}),j&&e.jsx("div",{className:"mt-4 text-red-500",children:j})]})})]}),e.jsxs("div",{className:"w-full md:w-2/5 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-600",children:"Additional Content"}),e.jsx("hr",{className:"mb-4"}),e.jsx("div",{className:"mt-1",children:e.jsx("button",{type:"button",onClick:a,className:"flex items-center text-lg font-semibold text-gray-600  mb-1 border w-full p-2","aria-expanded":V,"aria-controls":"assign-to-certificates",children:V?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"ml-1 mr-2"})," Certificates"]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"ml-1 mr-2"})," Certificates"]})})}),e.jsx(me.Collapse,{isOpened:V,theme:{collapse:"ReactCollapse--collapse"},children:e.jsx("div",{id:"assign-to-certificates",className:"mb-6 border w-full rounded-lg p-4 bg-gray-50",children:e.jsx(we,{})})}),e.jsx("div",{className:"mt-1",children:e.jsx("button",{type:"button",onClick:x,className:"flex items-center text-lg font-semibold text-gray-600  mb-1 border w-full p-2","aria-expanded":z,"aria-controls":"assign-to-lps",children:z?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"ml-1 mr-2"})," Learning Plans"]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"ml-1 mr-2"})," Learning Plans"]})})}),e.jsx(me.Collapse,{isOpened:z,theme:{collapse:"ReactCollapse--collapse"},children:e.jsx("div",{id:"assign-to-lps",className:"mb-6 border w-full rounded-lg p-4 bg-gray-50",children:e.jsx(ve,{})})}),e.jsx("div",{className:"mt-1",children:e.jsx("button",{type:"button",onClick:h,className:"flex items-center text-lg font-semibold text-gray-600  mb-1 border w-full p-2","aria-expanded":R,"aria-controls":"assign-to-bundles",children:R?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"ml-1 mr-2"})," Bundles"]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"ml-1 mr-2"})," Bundles"]})})}),e.jsx(me.Collapse,{isOpened:R,theme:{collapse:"ReactCollapse--collapse"},children:e.jsx("div",{id:"assign-to-bundles",className:"mb-6 border w-full rounded-lg p-4 bg-gray-50",children:e.jsx(Se,{})})}),e.jsxs("div",{className:"mt-6 p-3 rounded-lg border shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-600",children:"Recently Edited Courses"}),i?e.jsx("div",{children:"Loading recently edited courses..."}):G?e.jsx("div",{className:"text-red-500",children:G}):H.length>0?e.jsx("ul",{className:"space-y-2",children:H.map(t=>e.jsxs("li",{className:"flex justify-between items-center bg-white border-b pb-1",children:[e.jsx("span",{children:t.Name}),e.jsx("button",{onClick:()=>te(t.Id),className:"px-2 py-1 text-white rounded text-xs lms-button",children:"Edit"})]},t.Id))}):e.jsx("div",{children:"No recently edited courses."})]})]})]})},Le=()=>e.jsx("div",{className:"p-0",children:e.jsx(Pe,{})});export{Le as default};
