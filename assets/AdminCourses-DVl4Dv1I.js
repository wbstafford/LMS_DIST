import{c as te,d as re,r as t,w as de,j as e,ap as ae,af as H,ah as ne,aq as oe,B as d,f as Y,M as ge,A as ke,al as le,am as ie,ar as ce}from"./index-JlNpboNx.js";/* empty css              */const De=()=>{const{user:s}=te(),A=re(),[y,b]=t.useState([]),[$,D]=t.useState({key:"name",direction:"ascending"}),[v,x]=t.useState(""),[V,E]=t.useState(!1),[I,O]=t.useState(!1),[N,P]=t.useState(""),[i,j]=t.useState(1),[l,w]=t.useState(10),[f,C]=t.useState(1),[F,L]=t.useState(!1),[S,M]=t.useState(null),g=de(a=>{P(a),j(1)},300);t.useEffect(()=>()=>{g.cancel()},[]);const R=async()=>{const a=sessionStorage.getItem("token");if(!a){x("Authentication token is missing. Please log in again."),d.error("Authentication token is missing. Please log in again.");return}if(!(s!=null&&s.OrgID)){x("User organization ID is undefined."),d.error("User organization ID is undefined.");return}E(!0),x("");try{const n=(await Y.get("https://knowvara.com/api/api/learning-plans",{headers:{Authorization:`Bearer ${a}`},params:{search:N,page:i,limit:l,orgId:s.OrgID}})).data;n&&Array.isArray(n.data)?(b(n.data),C(n.totalPages)):(console.error("Fetched Learning Plans data is not valid"),b([]),C(1))}catch(h){console.error("Error fetching Learning Plans:",h),b([]),C(1),x("Failed to fetch Learning Plans."),d.error("Failed to fetch Learning Plans.")}finally{E(!1)}};t.useEffect(()=>{R()},[N,i,l]);const k=t.useMemo(()=>y.filter(a=>a.name.toLowerCase().includes(N.toLowerCase())||a.description&&a.description.toLowerCase().includes(N.toLowerCase())||a.objective&&a.objective.toLowerCase().includes(N.toLowerCase())),[y,N]);t.useEffect(()=>{C(l==="All"?1:Math.ceil(k.length/l)),j(1)},[k,l]);const U=t.useMemo(()=>{if(l==="All")return k;const a=i*l,h=a-l;return k.slice(h,a)},[k,i,l]),z=a=>{let h="ascending";$.key===a&&$.direction==="ascending"&&(h="descending"),D({key:a,direction:h});const n=[...k].sort((p,J)=>{var me,se;const _=((me=p[a])==null?void 0:me.toString().toLowerCase())||"",G=((se=J[a])==null?void 0:se.toString().toLowerCase())||"";return _<G?h==="ascending"?-1:1:_>G?h==="ascending"?1:-1:0});b(n)},B=async a=>{const h=sessionStorage.getItem("token");if(!h){console.error("No token found"),x("Authentication token is missing. Please log in again."),d.error("Authentication token is missing. Please log in again.");return}O(!0);try{await Y.delete(`https://knowvara.com/api/api/learning-plans/${a}`,{headers:{Authorization:`Bearer ${h}`}}),b(y.filter(n=>n.id!==a)),d.success("Learning Plan deleted successfully.")}catch(n){console.error("Error deleting Learning Plan:",n),x("Failed to delete Learning Plan."),d.error("Failed to delete Learning Plan.")}finally{O(!1),L(!1),M(null)}},Q=a=>{const h=a.target.value;if(h==="All")w("All"),C(1);else{const n=Number(h);w(n),C(Math.ceil(k.length/n))}j(1)},W=a=>{g(a.target.value)},o=()=>{A("/admin/learning-plan-form")},c=a=>{A(`/admin/learning-plan-form/${a}`)};return e.jsxs("div",{className:"pb-6",children:[" ",e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex flex-row justify-between items-center mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search learning plans...",onChange:W,className:"w-64 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2 text-gray-700 text-sm ml-2",children:"Show:"}),e.jsxs("select",{value:l,onChange:Q,className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:"All",children:"All"})]})]})]}),e.jsxs("button",{className:"flex items-center px-4 py-2 lms-button text-xs",onClick:o,children:[e.jsx(ae,{className:"mr-2"}),"Create Learning Plan"]})]}),v&&e.jsx("div",{className:"mb-4 text-red-500",children:v}),V?e.jsx("div",{children:"Loading Learning Plans..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>z("name"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"mr-2"}),"Name"]})}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>z("objective"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"mr-2"}),"Objective"]})}),e.jsx("th",{className:"w-8 py-2 px-2 border-b border-gray-200 text-center text-sm"}),e.jsx("th",{className:"w-8 py-2 px-2 border-b border-gray-200 text-center text-sm"})]})}),e.jsx("tbody",{children:U.length>0?U.map((a,h)=>e.jsxs("tr",{className:h%2===0?"bg-gray-50":"",children:[e.jsx("td",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer",onClick:()=>c(a.id),children:a.name}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:a.objective||"N/A"}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(ne,{size:18,className:"cursor-pointer lms-icon",onClick:()=>c(a.id),title:"Edit Learning Plan","aria-label":"Edit Learning Plan"})}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(oe,{size:18,className:"cursor-pointer lms-icon",onClick:()=>{M(a.id),L(!0)},title:"Delete Learning Plan","aria-label":"Delete Learning Plan"})})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-2 px-4 border-b border-gray-200 text-center",children:"No Learning Plans available"})})})]})}),f>1&&e.jsxs("div",{className:"flex justify-center items-center mt-4 space-x-2",children:[e.jsx("button",{onClick:()=>j(a=>Math.max(a-1,1)),disabled:i===1,className:`px-2 py-1 text-sm border rounded-md ${i===1?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Previous"}),Array.from({length:f},(a,h)=>h+1).map(a=>e.jsx("button",{onClick:()=>j(a),className:`px-2 py-1 text-sm border rounded-md ${i===a?"bg-blue-500 text-white":"bg-white hover:bg-gray-100"}`,children:a},a)),e.jsx("button",{onClick:()=>j(a=>Math.min(a+1,f)),disabled:i===f,className:`px-2 py-1 text-sm border rounded-md ${i===f?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Next"})]}),F&&S!==null&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",role:"dialog","aria-modal":"true","aria-labelledby":"delete-lp-modal-title",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-11/12 max-w-md",role:"document",children:[e.jsx("h2",{id:"delete-lp-modal-title",className:"text-xl font-semibold mb-4",children:"Confirm Deletion"}),e.jsx("p",{children:"Are you sure you want to delete this Learning Plan? This action cannot be undone."}),v&&e.jsx("div",{className:"mt-4 text-red-500",children:v}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx("button",{className:`bg-red-600 text-white px-4 py-2 rounded mr-2 hover:bg-red-700 ${I?"opacity-50 cursor-not-allowed":""}`,onClick:()=>B(S),disabled:I,children:I?"Deleting...":"Yes, Delete"}),e.jsx("button",{className:"bg-gray-300 text-black px-4 py-2 rounded hover:bg-gray-400",onClick:()=>{L(!1),M(null),x("")},disabled:I,children:"Cancel"})]})]})})]})},Pe=()=>{const{user:s}=te(),A=re(),[y,b]=t.useState([]),[$,D]=t.useState(!1),[v,x]=t.useState(""),[V,E]=t.useState(!1),[I,O]=t.useState(null),[N,P]=t.useState(""),[i,j]=t.useState(""),[l,w]=t.useState(1),[f,C]=t.useState(15),[F,L]=t.useState(1),[S,M]=t.useState(null),u=t.useMemo(()=>de(n=>{j(n),w(1)},300),[]);t.useEffect(()=>()=>{u.cancel()},[u]);const g=n=>{P(n.target.value),u(n.target.value)},R=n=>{const p=n.target.value;C(p==="All"?"All":Number(p)),w(1)},k=async()=>{const n=sessionStorage.getItem("token");if(!n||!(s!=null&&s.OrgID)){d.error("Authentication token is missing or user is not authenticated.");return}D(!0),x("");try{const p=await Y.get(`https://knowvara.com/api/api/certificates/${s.OrgID}`,{headers:{Authorization:`Bearer ${n}`}});b(p.data)}catch(p){console.error("Error fetching certificates:",p),x("Failed to fetch certificates."),d.error("Failed to fetch certificates.")}finally{D(!1)}};t.useEffect(()=>{s!=null&&s.OrgID&&k()},[s==null?void 0:s.OrgID]);const U=n=>{O(n),E(!0)},z=async()=>{if(!I)return;const n=sessionStorage.getItem("token");if(!n){d.error("Authentication token is missing."),E(!1),O(null);return}try{await Y.delete(`https://knowvara.com/api/api/certificates/${I.id}`,{headers:{Authorization:`Bearer ${n}`}}),d.success("Certificate deleted successfully."),k()}catch(p){console.error("Error deleting certificate:",p),d.error("Failed to delete certificate.")}finally{E(!1),O(null)}},B=()=>{E(!1),O(null)},Q=n=>{A(`/admin/certificate-form/${n}`)},W=()=>{A("/admin/certificate-form")},o=t.useMemo(()=>y.filter(n=>n.name.toLowerCase().includes(i.toLowerCase())),[y,i]),c=t.useMemo(()=>S!==null?[...o].sort((p,J)=>{const _=p[S.key],G=J[S.key];return typeof _=="string"&&typeof G=="string"?_.toLowerCase()<G.toLowerCase()?S.direction==="ascending"?-1:1:_.toLowerCase()>G.toLowerCase()?S.direction==="ascending"?1:-1:0:0}):o,[o,S]);t.useEffect(()=>{L(f==="All"?1:Math.ceil(c.length/f))},[c,f]);const a=t.useMemo(()=>{if(f==="All")return c;const n=l*f,p=n-f;return c.slice(p,n)},[c,l,f]),h=n=>{let p="ascending";S&&S.key===n&&S.direction==="ascending"&&(p="descending"),M({key:n,direction:p})};return e.jsxs("div",{className:"mt-1",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex flex-row items-center space-x-4",children:[e.jsx("input",{type:"text",placeholder:"Search certificates by name...",value:N,onChange:g,className:"w-64 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2 text-gray-700 text-sm",children:"Show:"}),e.jsxs("select",{value:f,onChange:R,className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm",children:[e.jsx("option",{value:15,children:"15"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:"All",children:"All"})]})]})]}),e.jsxs("button",{onClick:W,className:"flex items-center px-4 py-2 lms-button text-xs",children:[e.jsx(ae,{className:"mr-2"}),"Create Certificate"]})]}),$?e.jsx("div",{children:"Loading certificates..."}):v?e.jsx("div",{className:"text-red-500",children:v}):e.jsxs(e.Fragment,{children:[o.length===0?e.jsx("div",{children:"No certificates found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>h("name"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"mr-2"}),"Name"]})}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 text-sm",children:"Description"}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 text-sm",children:"Actions"})]})}),e.jsx("tbody",{children:a.map(n=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:n.name}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:n.description}),e.jsxs("td",{className:"py-2 px-4 border-b border-gray-200 w-24",children:[e.jsx("button",{onClick:()=>Q(n.id),className:"text-blue-600 hover:text-blue-800 mr-2",title:"Edit Certificate",children:e.jsx(ne,{size:18,className:"cursor-pointer lms-icon"})}),e.jsx("button",{onClick:()=>U(n),className:"text-red-600 hover:text-red-800",title:"Delete Certificate",children:e.jsx(oe,{size:18,className:"cursor-pointer lms-icon"})})]})]},n.id))})]})}),F>1&&e.jsxs("div",{className:"flex justify-center items-center mt-4 space-x-2",children:[e.jsx("button",{onClick:()=>w(n=>Math.max(n-1,1)),disabled:l===1,className:`px-2 py-1 text-sm border rounded-md ${l===1?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Previous"}),Array.from({length:F},(n,p)=>p+1).map(n=>e.jsx("button",{onClick:()=>w(n),className:`px-2 py-1 text-sm border rounded-md ${l===n?"bg-blue-500 text-white":"bg-white hover:bg-gray-100"}`,children:n},n)),e.jsx("button",{onClick:()=>w(n=>Math.min(n+1,F)),disabled:l===F,className:`px-2 py-1 text-sm border rounded-md ${l===F?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Next"})]})]}),V&&I&&e.jsx(ge,{title:"Delete Certificate",onClose:B,onConfirm:z,children:e.jsxs("p",{children:["Are you sure you want to delete the certificate"," ",e.jsx("strong",{children:I.name}),"?"]})})]})},Le=()=>{const{user:s}=te(),A=re(),[y,b]=t.useState([]),[$,D]=t.useState({key:"Name",direction:"ascending"}),[v,x]=t.useState(""),[V,E]=t.useState(!1),[I,O]=t.useState(""),[N,P]=t.useState(1),[i,j]=t.useState(15),[l,w]=t.useState(1),[f,C]=t.useState(!1),[F,L]=t.useState(null),M=de(o=>{O(o),P(1)},300);t.useEffect(()=>()=>{M.cancel()},[]);const u=async()=>{const o=sessionStorage.getItem("token");if(!o){x("Authentication token is missing. Please log in again."),d.error("Authentication token is missing. Please log in again.");return}if(!(s!=null&&s.OrgID)){x("User organization ID is undefined."),d.error("User organization ID is undefined.");return}E(!0),x("");try{const c=await Y.get(`https://knowvara.com/api/api/bundles/${s.OrgID}`,{headers:{Authorization:`Bearer ${o}`}});console.log("Fetched bundles:",c.data),Array.isArray(c.data)?b(c.data):(console.error("Fetched data is not an array"),b([]))}catch(c){console.error("Error fetching bundles:",c),b([]),x("Failed to fetch bundles."),d.error("Failed to fetch bundles.")}finally{E(!1)}};t.useEffect(()=>{s!=null&&s.OrgID&&u()},[s==null?void 0:s.OrgID]);const g=t.useMemo(()=>y.filter(o=>o.Name.toLowerCase().includes(I.toLowerCase())),[y,I]);t.useEffect(()=>{w(i==="All"?1:Math.ceil(g.length/i)),P(1)},[g,i]);const R=t.useMemo(()=>{if(i==="All")return g;const o=N*i,c=o-i;return g.slice(c,o)},[g,N,i]),k=o=>{let c="ascending";$.key===o&&$.direction==="ascending"&&(c="descending"),D({key:o,direction:c});const a=[...g].sort((h,n)=>{var _,G;const p=((_=h[o])==null?void 0:_.toString().toLowerCase())||"",J=((G=n[o])==null?void 0:G.toString().toLowerCase())||"";return p<J?c==="ascending"?-1:1:p>J?c==="ascending"?1:-1:0});b(a)},U=async o=>{const c=sessionStorage.getItem("token");if(!c){console.error("No token found"),x("Authentication token is missing. Please log in again."),d.error("Authentication token is missing. Please log in again.");return}try{await Y.delete(`https://knowvara.com/api/api/bundles/${s==null?void 0:s.OrgID}/${o}`,{headers:{Authorization:`Bearer ${c}`}}),b(y.filter(a=>a.Id!==o)),d.success("Bundle deleted successfully.")}catch(a){console.error("Error deleting bundle:",a),x("Failed to delete bundle."),d.error("Failed to delete bundle.")}finally{C(!1),L(null)}},z=o=>{const c=o.target.value;if(c==="All")j("All"),w(1);else{const a=Number(c);j(a),w(Math.ceil(g.length/a))}P(1)},B=o=>{M(o.target.value)},Q=()=>{A("/admin/bundle-form")},W=o=>{A(`/admin/bundle-form/${o}`)};return e.jsx("div",{className:"flex flex-col h-auto",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex flex-row justify-between items-center mb-2",children:[e.jsx("input",{type:"text",placeholder:"Search bundles by name...",onChange:B,className:"w-64 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2 text-gray-700 text-sm ml-2",children:"Show:"}),e.jsxs("select",{value:i,onChange:z,className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm",children:[e.jsx("option",{value:15,children:"15"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:"All",children:"All"})]})]})]}),e.jsxs("button",{className:"flex items-center px-4 py-2 lms-button text-xs",onClick:Q,children:[e.jsx(ae,{className:"mr-2"}),"Create New Bundle"]})]}),v&&e.jsx("div",{className:"mb-4 text-red-500",children:v}),V?e.jsx("div",{children:"Loading bundles..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>k("Name"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"mr-2"}),"Name"]})}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 text-sm",children:"Short Description"}),(s==null?void 0:s.ecommerce)&&e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>k("Price"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"mr-2"}),"Price"]})}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 text-sm w-28",children:"# Courses"}),e.jsx("th",{className:"py-2 px-2 border-b border-gray-200 text-center text-sm"}),e.jsx("th",{className:"py-2 px-2 border-b border-gray-200 text-center text-sm"})]})}),e.jsx("tbody",{children:R.length>0?R.map((o,c)=>{var a;return e.jsxs("tr",{className:c%2===0?"bg-gray-50":"",children:[e.jsx("td",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer",onClick:()=>W(o.Id),children:o.Name}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:o.ShortDescription}),(s==null?void 0:s.ecommerce)&&e.jsxs("td",{className:"py-2 px-4 border-b border-gray-200 text-center",children:["$",(a=o.Price)==null?void 0:a.toFixed(2)]}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200 text-center",children:o.courses.length}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(ne,{size:18,className:"cursor-pointer lms-icon",onClick:()=>W(o.Id),title:"Edit Bundle","aria-label":"Edit Bundle"})}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(oe,{size:18,className:"cursor-pointer lms-icon",onClick:()=>{L(o.Id),C(!0)},title:"Delete Bundle","aria-label":"Delete Bundle"})})]},o.Id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-2 px-4 border-b border-gray-200 text-center",children:"No bundles available"})})})]})}),l>1&&e.jsxs("div",{className:"flex justify-center items-center mt-4 space-x-2",children:[e.jsx("button",{onClick:()=>P(o=>Math.max(o-1,1)),disabled:N===1,className:`px-2 py-1 text-sm border rounded-md ${N===1?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Previous"}),Array.from({length:l},(o,c)=>c+1).map(o=>e.jsx("button",{onClick:()=>P(o),className:`px-2 py-1 text-sm border rounded-md ${N===o?"bg-blue-500 text-white":"bg-white hover:bg-gray-100"}`,children:o},o)),e.jsx("button",{onClick:()=>P(o=>Math.min(o+1,l)),disabled:N===l,className:`px-2 py-1 text-sm border rounded-md ${N===l?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Next"})]}),f&&F!==null&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",role:"dialog","aria-modal":"true","aria-labelledby":"delete-bundle-modal-title",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-11/12 max-w-md",role:"document",children:[e.jsx("h2",{id:"delete-bundle-modal-title",className:"text-xl font-semibold mb-4",children:"Confirm Deletion"}),e.jsx("p",{children:"Are you sure you want to delete this bundle? This action cannot be undone."}),v&&e.jsx("div",{className:"mt-4 text-red-500",children:v}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx("button",{className:`bg-red-600 text-white px-4 py-2 rounded mr-2 hover:bg-red-700 ${V?"opacity-50 cursor-not-allowed":""}`,onClick:()=>U(F),disabled:V,children:V?"Deleting...":"Yes, Delete"}),e.jsx("button",{className:"bg-gray-300 text-black px-4 py-2 rounded hover:bg-gray-400",onClick:()=>{C(!1),L(null),x("")},disabled:V,children:"Cancel"})]})]})})]})})},Ae=()=>{const{user:s}=te(),A=re(),[y,b]=t.useState([]),[$,D]=t.useState(""),[v,x]=t.useState(!1),[V,E]=t.useState("Name"),[I,O]=t.useState("ascending"),[N,P]=t.useState(!1),[i,j]=t.useState(null),[l,w]=t.useState(!1),f=async()=>{const u=sessionStorage.getItem("token");if(!u||!(s!=null&&s.OrgID)){D("Authentication token or OrgID is missing."),d.error("Authentication token or OrgID is missing.");return}x(!0),D("");try{const g=await Y.get(`https://knowvara.com/api/api/courses/${s.OrgID}/categories`,{headers:{Authorization:`Bearer ${u}`}});b(g.data)}catch(g){console.error("Error fetching categories:",g),D("Failed to fetch categories."),d.error("Failed to fetch categories.")}finally{x(!1)}};t.useEffect(()=>{s!=null&&s.OrgID&&f()},[s==null?void 0:s.OrgID]);const C=u=>{let g="ascending";V===u&&I==="ascending"&&(g="descending"),E(u),O(g);const R=[...y].sort((k,U)=>{let z=k[u],B=U[u];return typeof z=="string"&&(z=z.toLowerCase()),typeof B=="string"&&(B=B.toLowerCase()),z<B?g==="ascending"?-1:1:z>B?g==="ascending"?1:-1:0});b(R)},F=u=>{A(`/admin/category-form/${u}`)},L=u=>{j(u),P(!0)},S=async()=>{if(i===null)return;const u=sessionStorage.getItem("token");if(!u||!(s!=null&&s.OrgID)){D("Authentication token or OrgID is missing."),d.error("Authentication token or OrgID is missing.");return}w(!0),D("");try{await Y.delete(`https://knowvara.com/api/api/courses/${s.OrgID}/categories/${i}`,{headers:{Authorization:`Bearer ${u}`}}),d.success("Category deleted successfully."),b(y.filter(g=>g.Id!==i))}catch(g){console.error("Error deleting category:",g),D("Failed to delete category."),d.error("Failed to delete category.")}finally{w(!1),P(!1),j(null)}},M=()=>{A("/admin/category-form")};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-600",children:"Categories"}),e.jsxs("button",{className:"flex items-center px-4 py-2 lms-button text-xs",onClick:M,children:[e.jsx(ae,{className:"mr-1"}),"Create Category"]})]}),$&&e.jsx("div",{className:"mb-2 text-red-500",children:$}),v?e.jsx("div",{children:"Loading categories..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>C("Name"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"mr-2"}),"Name"]})}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>C("courseCount"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"mr-2"}),"# Courses"]})}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 text-center text-sm w-8"}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 text-center text-sm w-8"})]})}),e.jsx("tbody",{children:y.length>0?y.map((u,g)=>e.jsxs("tr",{className:g%2===0?"bg-gray-50":"",children:[e.jsx("td",{className:"py-2 px-4 border-b border-gray-200",children:u.Name}),e.jsx("td",{className:"py-2 px-4 border-b border-gray-200 text-center",children:u.courseCount}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(ne,{size:16,className:"cursor-pointer lms-icon mr-2",onClick:()=>F(u.Id),title:"Edit Category","aria-label":"Edit Category"})}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(oe,{size:16,className:"cursor-pointer lms-icon",onClick:()=>L(u.Id),title:"Delete Category","aria-label":"Delete Category"})})]},u.Id)):e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"py-2 px-4 border-b border-gray-200 text-center",children:"No categories available"})})})]})}),N&&i!==null&&e.jsxs(ge,{title:"Confirm Deletion",onClose:()=>{P(!1),j(null),D("")},onConfirm:S,confirmText:l?"Deleting...":"Yes, Delete",isConfirmDisabled:l,singleButton:!1,widthClassName:"max-w-md",children:[e.jsx("p",{children:"Are you sure you want to delete this category? This action cannot be undone."}),$&&e.jsx("div",{className:"mt-4 text-red-500",children:$})]})]})},$e=()=>{const{user:s}=te(),A=re(),[y,b]=t.useState([]),[$,D]=t.useState({key:"Name",direction:"ascending"}),[v,x]=t.useState(""),[V,E]=t.useState(!1),[I,O]=t.useState(!1),[N,P]=t.useState(""),[i,j]=t.useState(1),[l,w]=t.useState(12),[f,C]=t.useState(1),[F,L]=t.useState(!1),[S,M]=t.useState(null),[u,g]=t.useState(!1),[R,k]=t.useState(!1),[U,z]=t.useState(!1),[B,Q]=t.useState(!1),[W,o]=t.useState([]),[c,a]=t.useState(""),[h,n]=t.useState(!1),p=()=>{g(r=>!r)},J=()=>{k(r=>!r)},_=()=>{z(r=>!r)},G=()=>{Q(r=>!r)},se=de(r=>{P(r),j(1)},300);t.useEffect(()=>()=>{se.cancel()},[]);const ye=async()=>{const r=sessionStorage.getItem("token");if(!r){a("Authentication token is missing. Please log in again."),d.error("Authentication token is missing. Please log in again.");return}if(!(s!=null&&s.OrgID)){a("User organization ID is undefined."),d.error("User organization ID is undefined.");return}n(!0),a("");try{const m=await Y.get(`https://knowvara.com/api/api/courses/${s.OrgID}/recently-edited`,{headers:{Authorization:`Bearer ${r}`}});console.log("recent data: ",m.data),o(m.data)}catch(m){console.error("Error fetching recent courses:",m),a("Failed to fetch recently edited courses."),d.error("Failed to fetch recently edited courses.")}finally{n(!1)}};t.useEffect(()=>{s!=null&&s.OrgID&&ye()},[A,s==null?void 0:s.OrgID]);const Ne=async()=>{const r=sessionStorage.getItem("token");if(!r){x("Authentication token is missing. Please log in again."),d.error("Authentication token is missing. Please log in again.");return}if(!(s!=null&&s.OrgID)){x("User organization ID is undefined."),d.error("User organization ID is undefined.");return}E(!0),x("");try{const m=await Y.get(`https://knowvara.com/api/api/courses/${s.OrgID}`,{headers:{Authorization:`Bearer ${r}`}});console.log("Fetched courses:",m.data),Array.isArray(m.data)?b(m.data):(console.error("Fetched data is not an array"),b([]))}catch(m){console.error("Error fetching courses:",m),b([]),x("Failed to fetch courses."),d.error("Failed to fetch courses.")}finally{E(!1)}};t.useEffect(()=>{s!=null&&s.OrgID&&Ne()},[s==null?void 0:s.OrgID]);const X=t.useMemo(()=>y.filter(r=>r.Name.toLowerCase().includes(N.toLowerCase())),[y,N]);t.useEffect(()=>{C(l==="All"?1:Math.ceil(X.length/l)),j(1)},[X,l]);const he=t.useMemo(()=>{if(l==="All")return X;const r=(i-1)*l,m=r+l;return X.slice(r,m)},[X,i,l]),ue=r=>{let m="ascending";$.key===r&&$.direction==="ascending"&&(m="descending"),D({key:r,direction:m});const T=[...X].sort((K,Z)=>{var pe,je;const ee=K[r]==="y"?1:K[r]==="n"?0:((pe=K[r])==null?void 0:pe.toString().toLowerCase())||"",q=Z[r]==="y"?1:Z[r]==="n"?0:((je=Z[r])==null?void 0:je.toString().toLowerCase())||"";return ee<q?m==="ascending"?-1:1:ee>q?m==="ascending"?1:-1:0});b(T)},Ce=async(r,m)=>{const T=sessionStorage.getItem("token");if(!T){console.error("No token found");return}const K=y.find(q=>q.Id===r);if(!K)return;const Z=s==null?void 0:s.OrgID,ee=K[m]==="y"?"n":"y";try{await Y.patch(`https://knowvara.com/api/api/courses/${Z}/${r}`,{[m]:ee},{headers:{Authorization:`Bearer ${T}`}}),b(y.map(q=>q.Id===r?{...q,[m]:ee}:q)),d.success(`Course ${m} status updated successfully.`)}catch(q){console.error("Error updating course:",q),d.error("Failed to update course status.")}},ve=async r=>{const m=sessionStorage.getItem("token");if(!m){console.error("No token found"),x("Authentication token is missing. Please log in again."),d.error("Authentication token is missing. Please log in again.");return}O(!0);try{await Y.delete(`https://knowvara.com/api/api/courses/${r}`,{headers:{Authorization:`Bearer ${m}`}}),b(y.filter(T=>T.Id!==r)),d.success("Course deleted successfully.")}catch(T){console.error("Error deleting course:",T),x("Failed to delete course."),d.error("Failed to delete course.")}finally{O(!1),L(!1),M(null)}},we=r=>{const m=r.target.value;if(m==="All")w("All"),C(1);else{const T=Number(m);w(T),C(Math.ceil(X.length/T))}j(1)},Se=r=>{se(r.target.value)},Ie=()=>{A("/admin/course-form")},xe=r=>{A(`/admin/course-form/${r}`)},[be,fe]=t.useState({});return e.jsxs("div",{className:"flex flex-col md:flex-row h-auto min-h-[100%]",children:[e.jsxs("div",{className:"flex flex-col w-full md:w-3/5 p-4 md:border-r border-gray-300",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-600",children:"Courses"}),e.jsxs("button",{className:"flex items-center px-4 py-2 lms-button text-sm",onClick:Ie,children:[e.jsx(ae,{className:"mr-2"}),"Create New Course"]})]}),v&&e.jsx("div",{className:"mb-3 text-red-500",children:v}),e.jsxs("div",{className:"flex flex-row justify-between items-center mb-3",children:[e.jsx("input",{type:"text",placeholder:"Search courses by name...",onChange:Se,className:"w-64 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2 text-gray-700 text-sm",children:"Show:"}),e.jsxs("select",{value:l,onChange:we,className:"px-2 py-1 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm",children:[e.jsx("option",{value:12,children:"12"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:"All",children:"All"})]})]})]}),V?e.jsx("div",{children:"Loading courses..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"hidden sm:table-cell w-28 py-2 px-4 border-b border-gray-200",style:{minWidth:"26px"}}),e.jsx("th",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>ue("Name"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"mr-2"}),"Name"]})}),(s==null?void 0:s.ecommerce)&&e.jsx("th",{className:"w-24 py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>ue("Price"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"mr-2"}),"Price"]})}),e.jsx("th",{className:"w-24 py-2 px-4 border-b border-gray-200 cursor-pointer text-sm",onClick:()=>ue("Activated"),children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(H,{className:"mr-2"}),"Active"]})}),e.jsx("th",{className:"w-8 py-2 px-2 border-b border-gray-200 text-center text-sm"}),e.jsx("th",{className:"w-8 py-2 px-2 border-b border-gray-200 text-center text-sm"})]})}),e.jsx("tbody",{children:he.length>0?he.map((r,m)=>{var T;return e.jsxs("tr",{className:m%2===0?"bg-gray-50":"",children:[e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 hidden sm:table-cell",children:e.jsxs("div",{className:"relative w-28 h-14 object-cover rounded cursor-pointer",children:[!be[r.Id]&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"loader"})}),e.jsx("img",{src:r.ImageURL||"/GenericCourseIcon.webp",alt:`Course image for ${r.Name}`,loading:"lazy",className:`w-full h-full object-cover transition-opacity rounded duration-500 ${be[r.Id]?"opacity-100":"opacity-0"}`,onLoad:()=>{fe(K=>({...K,[r.Id]:!0}))},onError:K=>{const Z=K.target;Z.src="/GenericCourseIcon.webp",fe(ee=>({...ee,[r.Id]:!0}))}})]})}),e.jsxs("td",{className:"py-2 px-4 border-b border-gray-200 cursor-pointer",onClick:()=>xe(r.Id),children:[e.jsx("div",{className:"text-md font-semibold text-gray-800",children:r.Name}),e.jsx("div",{className:"hidden lg:block text-xs",children:r.ShortDescription})]}),(s==null?void 0:s.ecommerce)&&e.jsxs("td",{className:"w-24 py-2 px-4 border-b border-gray-200 text-center",children:["$",(T=r.Price)==null?void 0:T.toFixed(2)]}),e.jsx("td",{className:"w-24 py-2 px-4 border-b border-gray-200 text-center",children:e.jsx("div",{className:"ml-10",children:e.jsx("input",{type:"checkbox",checked:r.Activated==="y",onChange:()=>Ce(r.Id,"Activated"),className:"custom-checkbox"})})}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(ne,{size:18,className:"cursor-pointer lms-icon",onClick:()=>xe(r.Id),title:"Edit Course","aria-label":"Edit Course"})}),e.jsx("td",{className:"py-2 px-2 border-b border-gray-200 text-center",children:e.jsx(oe,{size:18,className:"cursor-pointer lms-icon",onClick:()=>{M(r.Id),L(!0)},title:"Delete Course","aria-label":"Delete Course"})})]},r.Id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:s!=null&&s.ecommerce?6:5,className:"py-2 px-4 border-b border-gray-200 text-center",children:"No courses available"})})})]})}),f>1&&e.jsxs("div",{className:"flex justify-center items-center mt-4 space-x-2",children:[e.jsx("button",{onClick:()=>j(r=>Math.max(r-1,1)),disabled:i===1,className:`px-2 py-1 text-sm border rounded-md ${i===1?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Previous"}),Array.from({length:f},(r,m)=>m+1).map(r=>e.jsx("button",{onClick:()=>j(r),className:`px-2 py-1 text-sm border rounded-md ${i===r?"bg-blue-500 text-white":"bg-white hover:bg-gray-100"}`,children:r},r)),e.jsx("button",{onClick:()=>j(r=>Math.min(r+1,f)),disabled:i===f,className:`px-2 py-1 text-sm border rounded-md ${i===f?"bg-gray-200 cursor-not-allowed":"bg-white hover:bg-gray-100"}`,children:"Next"})]}),e.jsx(ke,{children:F&&S!==null&&e.jsxs(ge,{title:"Confirm Deletion",onClose:()=>{L(!1),M(null),x("")},onConfirm:()=>ve(S),confirmText:I?"Deleting...":"Yes, Delete",isConfirmDisabled:I,singleButton:!1,widthClassName:"max-w-md",children:[e.jsx("p",{children:"Are you sure you want to delete this course? This action cannot be undone."}),v&&e.jsx("div",{className:"mt-4 text-red-500",children:v})]})})]}),e.jsxs("div",{className:"w-full md:w-2/5 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-600",children:"Additional Content"}),e.jsx("hr",{className:"mb-4"}),e.jsx("div",{className:"mt-1",children:e.jsx("button",{type:"button",onClick:J,className:"flex items-center text-lg font-semibold text-gray-600  mb-1 border w-full p-2","aria-expanded":R,"aria-controls":"assign-to-certificates",children:R?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"ml-1 mr-2"})," Certificates"]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"ml-1 mr-2"})," Certificates"]})})}),e.jsx(ce.Collapse,{isOpened:R,theme:{collapse:"ReactCollapse--collapse"},children:e.jsx("div",{id:"assign-to-certificates",className:"mb-6 border w-full rounded-lg p-4 bg-gray-50",children:e.jsx(Pe,{})})}),e.jsx("div",{className:"mt-1",children:e.jsx("button",{type:"button",onClick:p,className:"flex items-center text-lg font-semibold text-gray-600  mb-1 border w-full p-2","aria-expanded":u,"aria-controls":"assign-to-lps",children:u?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"ml-1 mr-2"})," Learning Plans"]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"ml-1 mr-2"})," Learning Plans"]})})}),e.jsx(ce.Collapse,{isOpened:u,theme:{collapse:"ReactCollapse--collapse"},children:e.jsx("div",{id:"assign-to-lps",className:"mb-6 border w-full rounded-lg p-4 bg-gray-50",children:e.jsx(De,{})})}),e.jsx("div",{className:"mt-1",children:e.jsx("button",{type:"button",onClick:_,className:"flex items-center text-lg font-semibold text-gray-600  mb-1 border w-full p-2","aria-expanded":U,"aria-controls":"assign-to-bundles",children:U?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"ml-1 mr-2"})," Bundles"]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"ml-1 mr-2"})," Bundles"]})})}),e.jsx(ce.Collapse,{isOpened:U,theme:{collapse:"ReactCollapse--collapse"},children:e.jsx("div",{id:"assign-to-bundles",className:"mb-6 border w-full rounded-lg p-4 bg-gray-50",children:e.jsx(Le,{})})}),e.jsx("div",{className:"mt-1",children:e.jsx("button",{type:"button",onClick:G,className:"flex items-center text-lg font-semibold text-gray-600 mb-1 border w-full p-2","aria-expanded":B,"aria-controls":"assign-to-categories",children:B?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"ml-1 mr-2"})," Categories"]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"ml-1 mr-2"})," Categories"]})})}),e.jsx(ce.Collapse,{isOpened:B,theme:{collapse:"ReactCollapse--collapse"},children:e.jsx("div",{id:"assign-to-categories",className:"mb-6 border w-full rounded-lg p-4 bg-gray-50",children:e.jsx(Ae,{})})}),e.jsxs("div",{className:"mt-6 p-3 rounded-lg border shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-600",children:"Recently Edited Courses"}),h?e.jsx("div",{children:"Loading recently edited courses..."}):c?e.jsx("div",{className:"text-red-500",children:c}):W.length>0?e.jsx("ul",{className:"space-y-2",children:W.map(r=>e.jsxs("li",{className:"flex justify-between items-center bg-white border-b pb-1",children:[e.jsx("span",{children:r.Name}),e.jsx("button",{onClick:()=>xe(r.Id),className:"px-2 py-1 text-white rounded text-xs lms-button",children:"Edit"})]},r.Id))}):e.jsx("div",{children:"No recently edited courses."})]})]})]})},Oe=()=>e.jsx("div",{className:"p-0",children:e.jsx($e,{})});export{Oe as default};
